<ion-content [fullscreen]="true" class="ion-padding">
    <div class="app-background" [style.background-image]="'url(' + backgroundImage() + ')'">
        <div class="background-overlay"></div>
    </div>

    <div class="header-section d-flex justify-content-between align-items-center mb-4">
        <ion-item lines="none" class="language-selector">
            <ion-select interface="popover" [label]=" 'language_label' | translate " placeholder="Select Language"
                (ionChange)="changeLanguage($event)" [value]="translationService.currentLang()">
                <ion-select-option value="en-GB">English (UK)</ion-select-option>
                <ion-select-option value="es-ES">Spanish (Spain)</ion-select-option>
                <ion-select-option value="pt-PT">Portuguese (Portugal)</ion-select-option>
            </ion-select>
        </ion-item>
    </div>

    @if (loading()) {
    <div class="loading-container d-flex justify-content-center align-items-center">
        <ion-spinner name="crescent" color="primary"></ion-spinner>
    </div>
    } @else {
    <div class="organism-section mb-4">
        <app-forecast-details-organism [cityName]="cityName()" [currentTemp]="currentTemp()" [forecasts]="forecasts()"
            [details]="weatherDetails()" [lang]="translationService.currentLang()"></app-forecast-details-organism>
    </div>

    <div class="forecast-section mt-4 px-2">
        <h3 class="section-title text-white fw-bold mb-3 fs-3">{{ 'forecast_label' | translate }}</h3>
        <div class="daily-forecast-list">
            @for (day of dailyForecasts(); track day.dt) {
            <app-daily-forecast [dt]="day.dt" [icon]="day.icon" [description]="day.description" [minTemp]="day.minTemp"
                [maxTemp]="day.maxTemp" [lang]="translationService.currentLang()"></app-daily-forecast>
            }
        </div>
    </div>
    }
    
    <div class="bottom-spacer"></div>

</ion-content>
<div class="fixed-bottom-search px-4 pb-4 pt-2">
    @if (searchResults().length > 0) {
    <div class="search-results-list mb-3">
        <ion-list class="rounded-xl overflow-hidden glass-list">
            @for (city of searchResults(); track city.lat + city.lon) {
            <ion-item button (click)="selectCity(city)" lines="none" class="search-item">
                <ion-icon name="location-outline" slot="start" class="location-icon"></ion-icon>
                <ion-label>
                    <h3 class="fw-bold text-white fs-6">{{ city.name }}</h3>
                    <p class="text-white opacity-75 fs-7">{{ city.state ? city.state + ', ' : '' }}{{ city.country }}
                    </p>
                </ion-label>
            </ion-item>
            }
        </ion-list>
    </div>
    }
    <app-search-bar [placeholder]="'search_bar_placeholder' | translate" (search)="searchCity($event)"></app-search-bar>
</div>